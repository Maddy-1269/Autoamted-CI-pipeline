pipeline {
  agent any
  stages {
    stage('Checkout') { steps { checkout scm } }
    stage('Install') { steps { sh 'npm ci' } }
    stage('Test') {
      steps { sh 'npm test' }
      post { always { junit 'test-results/junit.xml'; archiveArtifacts artifacts: 'test-results/**', allowEmptyArchive: true } }
    }
    stage('Build & Package') {
      steps {
        sh 'npm run build'
        sh 'cd build && zip -r ../artifact.zip .'
        archiveArtifacts artifacts: 'artifact.zip', fingerprint: true
      }
    }
  }
  post {
    success { echo 'SUCCESS' }
    failure { echo 'FAILURE' }
  }
}
